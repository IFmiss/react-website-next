{"ast":null,"code":"var _jsxFileName = \"/Users/daiwei/pr/react-website-next/pages/blog/detail/index.tsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport Layout from '@components/Layout';\nimport { ARTICLE_DETAIL } from '@constance/api';\nimport classNames from 'classnames';\nimport { PROJECT_NAME } from '@constance/index';\nimport http from '@utils/req';\nimport ReactMarkdown from 'react-markdown';\nimport './detail.less';\nimport CodeBlock from \"@components/CodeBlock\";\nimport Link from 'next/link';\nimport LazyLoad from 'react-lazyload';\nimport MainAction from '@root/store/actions/index';\nimport { connect } from 'react-redux';\nimport ReactDOM from 'react-dom';\n\nconst BlogDetail = props => {\n  const {\n    detail,\n    prev,\n    next\n  } = props;\n  const classString = classNames({\n    [`${PROJECT_NAME}-blog-detail`]: true\n  });\n  useEffect(() => {\n    eleToTop();\n    renderImage();\n  }, []);\n\n  const renderImage = () => {\n    const zImage = import('react-zmage');\n    const imgs = Array.from(document.querySelectorAll('.react-next-web-blog-detail img'));\n    const lists = imgs.map(item => ({\n      src: item.getAttribute('src') || '',\n      alt: item.getAttribute('alt') || ''\n    }));\n    imgs.forEach((item, index) => {\n      var _item$parentNode;\n\n      const {\n        src,\n        alt\n      } = lists[index];\n      const ele = document.createElement('p');\n      ele.className = 'image-wrapper';\n      const wrapperEle = item.parentNode && item.parentNode.insertBefore(ele, item);\n      (_item$parentNode = item.parentNode) === null || _item$parentNode === void 0 ? void 0 : _item$parentNode.removeChild(item);\n      ReactDOM.render(__jsx(React.Fragment, null, __jsx(LazyLoad, {\n        placeholder: __jsx(\"img\", {\n          className: \"title-header-logo\",\n          src: \"https://w4.hoopchina.com.cn/images/m/default_head.png\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, __jsx(\"img\", {\n        src: src,\n        alt: alt,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }))), wrapperEle);\n    });\n  };\n\n  const eleToTop = () => {\n    const ele = document.getElementById('dw-next-container');\n\n    if (ele) {\n      ele.scrollTop = 0;\n    }\n  };\n\n  return detail && detail.id ? __jsx(Layout, {\n    title: detail.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classString,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: `${classString}-title`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, detail.name), __jsx(ReactMarkdown, {\n    source: detail.content,\n    escapeHtml: true,\n    skipHtml: true,\n    renderers: {\n      code: CodeBlock\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: `${classString}-entry`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, prev && prev.id ? __jsx(Link, {\n    href: `/blog/detail?id=${prev.id}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: `${classString}-entry-prev`,\n    title: prev.name || '',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, prev.name ? `上一篇 : ${prev.name}` : '')) : null, next && next.id ? __jsx(Link, {\n    href: `/blog/detail?id=${next.id}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: `${classString}-entry-next`,\n    title: next.name || '',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, next.name ? `下一篇 : ${next.name}` : '')) : null))) : __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, \"\\u52A0\\u8F7D\\u4E2D...\");\n};\n\nBlogDetail.getInitialProps = async ctx => {\n  const {\n    id\n  } = ctx.query;\n  const {\n    data\n  } = await http.get(`${ARTICLE_DETAIL}/${id}`);\n  return {\n    detail: data.result && data.result.detail || {},\n    next: data.result && data.result.next || null,\n    prev: data.result && data.result.prev || null\n  };\n};\n\nconst mapState = state => ({\n  containerEle: state.base.containerEle\n});\n\nconst mapDispatch = MainAction;\nexport default connect(mapState, mapDispatch)(BlogDetail);","map":{"version":3,"sources":["/Users/daiwei/pr/react-website-next/pages/blog/detail/index.tsx"],"names":["React","useEffect","Layout","ARTICLE_DETAIL","classNames","PROJECT_NAME","http","ReactMarkdown","CodeBlock","Link","LazyLoad","MainAction","connect","ReactDOM","BlogDetail","props","detail","prev","next","classString","eleToTop","renderImage","zImage","imgs","Array","from","document","querySelectorAll","lists","map","item","src","getAttribute","alt","forEach","index","ele","createElement","className","wrapperEle","parentNode","insertBefore","removeChild","render","getElementById","scrollTop","id","name","content","code","getInitialProps","ctx","query","data","get","result","mapState","state","containerEle","base","mapDispatch"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react'\nimport {\n  NextPage\n} from 'next'\nimport Layout from '@components/Layout'\nimport {\n  ARTICLE_DETAIL\n} from '@constance/api'\nimport classNames from 'classnames'\nimport {\n  PROJECT_NAME\n} from '@constance/index'\nimport http from '@utils/req'\nimport ReactMarkdown from 'react-markdown'\nimport './detail.less'\nimport CodeBlock from \"@components/CodeBlock\";\nimport Link from 'next/link'\nimport LazyLoad from 'react-lazyload'\n\nimport { \n  IStore\n} from '@store/types';\nimport MainAction from '@root/store/actions/index'\nimport { connect } from 'react-redux'\nimport ReactDOM from 'react-dom'\n\ninterface IBlogListCategorieOrTag {\n  id: string;\n  name: string;\n}\n\ninterface IBlogDetail {\n  id: string;\n  name: string;\n  readCount: string;\n  editDate: string;\n  createDate: string;\n  tagLists: IBlogListCategorieOrTag[];\n  content: string;\n}\n\ninterface IBlogPrevNext {\n  id: string | null;\n  name: string | null;\n}\n\ninterface BlogDetailProps {\n  detail: IBlogDetail,\n  next: IBlogPrevNext,\n  prev: IBlogPrevNext\n}\n\nconst BlogDetail: NextPage<BlogDetailProps, {}> = (props) => {\n  const { detail, prev, next } = props\n  const classString = classNames({\n    [`${PROJECT_NAME}-blog-detail`]: true\n  })\n\n  useEffect(() => {\n    eleToTop()\n    renderImage()\n  }, [])\n\n  const renderImage = () => {\n    const zImage = import('react-zmage')\n    const imgs = Array.from(document.querySelectorAll('.react-next-web-blog-detail img'))\n    const lists = imgs.map(item => (\n      {\n        src: item.getAttribute('src') || '',\n        alt: item.getAttribute('alt') || ''\n      }\n    ))\n    imgs.forEach((item, index) => {\n      const { src, alt } = lists[index]\n      const ele = document.createElement('p')\n      ele.className = 'image-wrapper'\n      const wrapperEle = item.parentNode && item.parentNode.insertBefore(ele, item)\n      item.parentNode?.removeChild(item)\n      ReactDOM.render(\n        <>\n          <LazyLoad\n            placeholder={\n              <img\n                className=\"title-header-logo\"\n                src=\"https://w4.hoopchina.com.cn/images/m/default_head.png\"\n              />\n            }\n          >\n            <img src={src} alt={alt}/>\n          </LazyLoad>\n        </>,\n        wrapperEle as Element\n      )\n    })\n  }\n  \n  const eleToTop = () => {\n    const ele = document.getElementById('dw-next-container')\n    if (ele) {\n      ele.scrollTop = 0\n    }\n  }\n\n  return (\n    (\n      detail && detail.id ? (\n        <Layout title={detail.name}>\n          <div className={classString}>\n            <h1 className={`${classString}-title`}>{detail.name}</h1>\n            <ReactMarkdown\n              source={detail.content}\n              escapeHtml={true}\n              skipHtml={true}\n              renderers={{\n                code: CodeBlock\n              }}/>\n            <div className={`${classString}-entry`}>\n              {\n                prev && prev.id ? (\n                  <Link href={`/blog/detail?id=${prev.id}`}>\n                    <a className={`${classString}-entry-prev`}\n                        title={prev.name || ''}>\n                      { prev.name ? `上一篇 : ${prev.name}` : '' }\n                    </a>\n                  </Link>\n                ) : null\n              }\n              {\n                next && next.id ? (\n                  <Link href={`/blog/detail?id=${next.id}`}>\n                    <a className={`${classString}-entry-next`}\n                        title={next.name || ''}>\n                      { next.name ? `下一篇 : ${next.name}` : '' }\n                    </a>\n                  </Link >\n                ) : null\n              }\n            </div>\n          </div>\n        </Layout>\n      ) : (\n        <div>加载中...</div>\n      )\n    )\n  )\n}\n\nBlogDetail.getInitialProps = async (ctx) => {\n  const { id }  = ctx.query\n  const { data } = await http.get(`${ARTICLE_DETAIL}/${id}`)\n  return {\n    detail: data.result && data.result.detail || {},\n    next: data.result && data.result.next || null,\n    prev: data.result && data.result.prev || null\n  }\n}\n\nconst mapState = (state: IStore) => ({ \n  containerEle: state.base.containerEle\n })\n\nconst mapDispatch = MainAction\n\nexport default connect(mapState, mapDispatch)(BlogDetail)\n"]},"metadata":{},"sourceType":"module"}